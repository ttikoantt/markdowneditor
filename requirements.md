# マークダウンエディター 要件定義書

## 1. プロジェクト概要

### 1.1 目的
Obsidianライクな、WYSIWYG（What You See Is What You Get）スタイルのマークダウンエディターをWebアプリケーションとして開発する。ユーザーはWordのような直感的な見た目で編集しながら、実際にはマークダウン形式でファイルを保存できる。軽量で配布が簡単なWebアプリとして提供し、将来的にはElectronでラップしてデスクトップアプリとしても展開する。

### 1.2 ターゲットユーザー
- マークダウン記法を学びたくないが、プレーンテキストで文書を管理したい人
- Wordのような操作感を求めつつ、マークダウンの利便性を享受したい人
- ナレッジベース・メモ管理ツールを求めている人
- インストール不要で即座に使えるエディターを求めている人

### 1.3 配布方法
- **メインプラットフォーム**: GitHub Pagesでホスティングされる軽量Webアプリケーション
- **将来的な展開**: Electronでラップしたデスクトップアプリ版（オプション）

---

## 2. 機能要件

### 2.1 コアエディター機能

#### 2.1.1 WYSIWYGエディター
- **優先度**: 高
- **内容**:
  - リッチテキストエディターのような見た目で編集
  - 太字、斜体、下線、取り消し線などの装飾が視覚的に表示される
  - 見出し（H1〜H6）が実際の大きさで表示される
  - リスト（箇条書き、番号付き）が適切にインデントされる
  - リンク、画像が視覚的に表示される
  - コードブロック、引用が視覚的に区別される
  - テーブルがグリッド形式で表示・編集可能

#### 2.1.2 マークダウン形式での保存
- **優先度**: 高
- **内容**:
  - すべての編集内容をマークダウン記法に変換して保存
  - CommonMark または GitHub Flavored Markdown (GFM) に準拠
  - ファイル拡張子は `.md`

#### 2.1.3 ツールバー操作
- **優先度**: 高
- **内容**:
  - ツールバーから以下の操作が可能:
    - テキスト装飾（太字、斜体、下線、取り消し線）
    - 見出しレベル選択（H1〜H6）
    - リスト作成（箇条書き、番号付き、チェックボックス）
    - リンク挿入
    - 画像挿入
    - コードブロック挿入
    - 引用挿入
    - テーブル挿入

#### 2.1.4 キーボードショートカット
- **優先度**: 中
- **内容**:
  - 一般的なショートカットのサポート:
    - `Cmd/Ctrl + B`: 太字
    - `Cmd/Ctrl + I`: 斜体
    - `Cmd/Ctrl + U`: 下線
    - `Cmd/Ctrl + K`: リンク挿入
    - `Cmd/Ctrl + Shift + C`: コードブロック
    - など

### 2.2 ファイル・フォルダ管理

#### 2.2.1 ワークスペース管理
- **優先度**: 高
- **内容**:
  - ユーザーが任意のフォルダをワークスペースとして指定可能（File System Access API使用）
  - 複数のワークスペースを保存・切り替え可能（ブラウザストレージに保存）
  - ワークスペース内のフォルダ構造をサイドバーに表示
  - 初回アクセス時にフォルダへのアクセス許可を要求
  - フォルダハンドルの永続化（可能な場合）

#### 2.2.2 ファイル操作
- **優先度**: 高
- **内容**:
  - ファイルの新規作成、開く、保存、削除
  - ファイル名変更
  - ファイルの移動（ドラッグ&ドロップ）
  - 複数ファイルの同時編集（タブ機能）

#### 2.2.3 フォルダ操作
- **優先度**: 中
- **内容**:
  - フォルダの新規作成、削除、名前変更
  - フォルダの階層構造の表示
  - フォルダの展開・折りたたみ

#### 2.2.4 ファイル検索
- **優先度**: 中
- **内容**:
  - ワークスペース内のファイル名検索
  - ファイル内容の全文検索（将来的な拡張）

### 2.3 マークダウン機能

#### 2.3.1 基本マークダウン記法
- **優先度**: 高
- **対応記法**:
  - 見出し（`#`, `##`, など）
  - 太字（`**text**`）
  - 斜体（`*text*`）
  - 取り消し線（`~~text~~`）
  - リスト（`-`, `*`, `1.`）
  - チェックボックス（`- [ ]`, `- [x]`）
  - リンク（`[text](url)`）
  - 画像（`![alt](url)`）
  - コードブロック（` ``` `）
  - インラインコード（`` `code` ``）
  - 引用（`>`）
  - 水平線（`---`）
  - テーブル

#### 2.3.2 拡張マークダウン記法（オプション）
- **優先度**: 低
- **対応記法**:
  - 数式（LaTeX）
  - 脚注
  - タスクリスト
  - シンタックスハイライト

### 2.4 UI/UX機能

#### 2.4.1 レイアウト
- **優先度**: 高
- **内容**:
  - サイドバー（ファイルツリー表示）
  - メインエディターエリア
  - ツールバー/メニューバー
  - ステータスバー（文字数、行数など）

#### 2.4.2 テーマ・外観
- **優先度**: 中
- **内容**:
  - ライトモード・ダークモードの切り替え
  - フォントサイズ調整
  - エディター幅の調整

#### 2.4.3 プレビュー機能（オプション）
- **優先度**: 低
- **内容**:
  - マークダウンソースコードの表示/非表示切り替え
  - サイドバイサイドプレビュー

### 2.5 その他の機能

#### 2.5.1 自動保存
- **優先度**: 高
- **内容**:
  - 編集内容を一定時間ごとに自動保存
  - 保存状態の表示

#### 2.5.2 履歴・元に戻す
- **優先度**: 高
- **内容**:
  - Undo/Redo機能
  - 編集履歴の管理

#### 2.5.3 設定
- **優先度**: 中
- **内容**:
  - アプリケーション設定の保存
  - エディター設定（フォント、テーマなど）
  - キーボードショートカットのカスタマイズ

---

## 3. 非機能要件

### 3.1 パフォーマンス
- 大きなファイル（10,000行以上）でも快適に動作
- ファイル保存は即座に完了（1秒以内）
- UIの応答性（60fps以上）
- 初回ロード時間: 3秒以内（モバイル4G回線）
- バンドルサイズ: 500KB以下（gzip圧縮後）

### 3.2 互換性
- モダンブラウザ対応（Chrome 86+、Edge 86+、Safari 15.2+）
- 既存のマークダウンファイルとの互換性（CommonMark、GFM）
- レスポンシブデザイン（モバイル、タブレット、デスクトップ）

### 3.3 セキュリティ
- File System Access APIの安全な使用（ユーザー許可必須）
- XSS攻撃の防止
- CSP（Content Security Policy）の適用
- HTTPS必須（GitHub Pages標準）

### 3.4 アクセシビリティ
- WCAG 2.1 AA準拠
- キーボードナビゲーション対応
- スクリーンリーダー対応

### 3.5 拡張性
- プラグインシステム（将来的な拡張）
- カスタムテーマのサポート
- モジュール化されたアーキテクチャ

---

## 4. 技術的制約

### 4.1 プラットフォーム
- **プライマリ**: Webアプリケーション（モダンブラウザ対応）
  - Chrome 86+（File System Access API対応）
  - Edge 86+
  - Safari 15.2+
- **セカンダリ**: Electronベースのデスクトップアプリ（Phase 3）
- クロスプラットフォーム対応

### 4.2 データストレージ
- **Webアプリ版**:
  - ローカルファイルシステム（File System Access API）
  - 設定データ: localStorage / IndexedDB
  - オフラインキャッシュ: Service Worker + Cache API
- **デスクトップ版（将来）**:
  - Node.js fs APIによる直接ファイルアクセス
  - 設定ファイルはJSON形式

### 4.3 依存ライブラリ
- WYSIWYGエディター: TipTap（ProseMirrorベース）
- マークダウンパーサー: unified, remark, remark-parse/stringify
- フロントエンドフレームワーク: React 18+
- ビルドツール: Vite
- 状態管理: Zustand
- スタイリング: TailwindCSS

### 4.4 ブラウザ互換性
- File System Access APIが利用不可能なブラウザでは、以下の代替手段を提供:
  - ファイルダウンロード/アップロードによるエクスポート/インポート
  - IndexedDBへのデータ保存（ブラウザ内のみ）
  - 機能制限モードの表示

---

## 5. 除外項目（スコープ外）

以下の機能は初期バージョンでは対応しない:

- クラウド同期機能
- モバイルアプリ
- リアルタイム共同編集
- バージョン管理システム（Git）統合
- PDFエクスポート（将来的な拡張候補）
- プラグインマーケットプレイス

---

## 6. 成功基準

- ユーザーがマークダウン記法を意識せずに文書を作成できる
- Wordと同等の直感的な操作感
- マークダウンファイルとして正しく保存・読み込みができる
- 既存のマークダウンエディター（Obsidian、Typora等）と競合できる使いやすさ

---

## 7. リリース計画

### Phase 1（MVP - Webアプリ版）
- 基本的なWYSIWYGエディター（TipTap使用）
- ファイル・フォルダ操作（File System Access API）
- 基本マークダウン記法対応
- ワークスペース管理
- **テーマ切り替え（ライト/ダークモード）**
- **全文検索機能**
- **画像貼り付け機能（クリップボード、ドラッグ&ドロップ）**
- **テーブル編集機能**
- 積極的自動保存（500ms）
- Service Workerによるオフライン対応

### Phase 2（機能拡張）
- キーボードショートカットカスタマイズ
- エクスポート機能（PDF、HTML）
- 高度なマークダウン記法（数式、図表）
- プラグインシステム基盤

### Phase 3（デスクトップアプリ版）
- Electronでラップしたデスクトップアプリ
- より強力なファイルシステム統合
- システムトレイ統合
- その他のユーザーフィードバックに基づく機能

---

**作成日**: 2026-01-10
**バージョン**: 1.0

---

## 関連ドキュメント

- [設計書](./design.md) - 技術設計とアーキテクチャ
- [アーキテクチャレビュー](./architecture-review.md) - アーキテクト視点での評価
- [TDD戦略](./tdd-strategy.md) - テスト駆動開発のアプローチ
- [テストケース仕様](./test-cases.md) - 詳細なテストケース一覧
- [テストスイートテンプレート](./test-suite-templates.md) - すぐに使えるテストコードテンプレート

---
